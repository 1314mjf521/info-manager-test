import{_ as me}from"./_plugin-vue_export-helper-BJA4NJ9J.js";/* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css                  */import{h as A,A as M,u as Je}from"./index-Co-C_Vux.js";import{f as ce,l as fe,M as _e,N as ve,F as ge,P as Ke,I as Se,b as Ae,c as De,d as Pe,J as ye,K as be,V as Ue,e as $e,G as se,E as b,Q as Ge,y as Qe,A as We,z as Ze,W as et,X as tt,Y as lt,L as ot,C as at,Z as st}from"./element-CUclIBtA.js";import{y as Ve,r as v,l as we,h as xe,z as g,B as y,R as e,J as l,O as s,al as oe,P as R,A as u,j as he,a4 as nt,Q as K,a6 as G,n as rt,I as j,L as N}from"./vendor-B2dHd6i_.js";/* empty css                      *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                             */import"./utils-xdQVjYpF.js";const dt={class:"template-manager"},it={class:"action-bar"},ut=Ve({__name:"TemplateManager",emits:["template-updated","close"],setup(ne,{emit:H}){const I=H,S=v(),U=v([]),k=v(!1),F=v(!1),V=v(null),p=we({name:"",description:"",format:"excel",config:{fields:["title","type","status","creator","createdAt"],sortBy:"createdAt",sortOrder:"desc"}}),E={name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:1,max:50,message:"模板名称长度在 1 到 50 个字符",trigger:"blur"}],format:[{required:!0,message:"请选择导出格式",trigger:"change"}]},m=f=>se(f).format("YYYY-MM-DD HH:mm"),h=async()=>{try{const f=await A.get(M.EXPORT.TEMPLATES);U.value=f}catch(f){console.error("Failed to load templates:",f),b.error("加载模板列表失败")}},r=()=>{Object.assign(p,{name:"",description:"",format:"excel",config:{fields:["title","type","status","creator","createdAt"],sortBy:"createdAt",sortOrder:"desc"}}),V.value=null},X=f=>{V.value=f,Object.assign(p,{name:f.name,description:f.description||"",format:f.format,config:{...f.config}}),k.value=!0},D=async f=>{try{await A.delete(`${M.EXPORT.TEMPLATES}/${f.id}`),b.success("模板删除成功"),await h(),I("template-updated")}catch(n){console.error("Delete template failed:",n),b.error("删除失败")}},Z=async()=>{if(S.value)try{if(await S.value.validate(),p.config.fields.length===0){b.warning("请至少选择一个导出字段");return}F.value=!0;const f={name:p.name,description:p.description,format:p.format,config:p.config};V.value?(await A.put(`${M.EXPORT.TEMPLATES}/${V.value.id}`,f),b.success("模板更新成功")):(await A.post(M.EXPORT.TEMPLATES,f),b.success("模板创建成功")),k.value=!1,r(),await h(),I("template-updated")}catch(f){console.error("Save template failed:",f),b.error(f.message||"保存失败")}finally{F.value=!1}},q=()=>{k.value=!1,r()};return xe(()=>{h()}),(f,n)=>{const ee=oe("Plus"),d=fe,i=ce,C=ve,J=ge,O=Ke,te=_e,Q=Pe,$=De,w=be,L=ye,P=$e,le=Ue,_=Ae,re=Se;return u(),g("div",dt,[y("div",it,[e(i,{type:"primary",onClick:n[0]||(n[0]=c=>k.value=!0)},{default:l(()=>[e(d,null,{default:l(()=>[e(ee)]),_:1}),n[8]||(n[8]=s(" 新建模板 ",-1))]),_:1})]),e(te,{data:U.value,stripe:""},{default:l(()=>[e(C,{prop:"name",label:"模板名称","min-width":"150"}),e(C,{prop:"description",label:"描述","min-width":"200"},{default:l(({row:c})=>[s(R(c.description||"无描述"),1)]),_:1}),e(C,{prop:"format",label:"格式",width:"80"},{default:l(({row:c})=>[e(J,{size:"small"},{default:l(()=>[s(R(c.format.toUpperCase()),1)]),_:2},1024)]),_:1}),e(C,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(({row:c})=>[s(R(m(c.createdAt)),1)]),_:1}),e(C,{label:"操作",width:"150",fixed:"right"},{default:l(({row:c})=>[e(i,{size:"small",onClick:de=>X(c)},{default:l(()=>[...n[9]||(n[9]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"]),e(O,{title:"确定要删除这个模板吗？",onConfirm:de=>D(c)},{reference:l(()=>[e(i,{size:"small",type:"danger"},{default:l(()=>[...n[10]||(n[10]=[s(" 删除 ",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(re,{modelValue:k.value,"onUpdate:modelValue":n[7]||(n[7]=c=>k.value=c),title:V.value?"编辑模板":"新建模板",width:"600px"},{footer:l(()=>[e(i,{onClick:q},{default:l(()=>[...n[19]||(n[19]=[s("取消",-1)])]),_:1}),e(i,{type:"primary",loading:F.value,onClick:Z},{default:l(()=>[s(R(V.value?"更新":"创建"),1)]),_:1},8,["loading"])]),default:l(()=>[e(_,{ref_key:"templateFormRef",ref:S,model:p,rules:E,"label-width":"100px"},{default:l(()=>[e($,{label:"模板名称",prop:"name"},{default:l(()=>[e(Q,{modelValue:p.name,"onUpdate:modelValue":n[1]||(n[1]=c=>p.name=c),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),e($,{label:"描述"},{default:l(()=>[e(Q,{modelValue:p.description,"onUpdate:modelValue":n[2]||(n[2]=c=>p.description=c),type:"textarea",rows:3,placeholder:"请输入模板描述"},null,8,["modelValue"])]),_:1}),e($,{label:"导出格式",prop:"format"},{default:l(()=>[e(L,{modelValue:p.format,"onUpdate:modelValue":n[3]||(n[3]=c=>p.format=c),placeholder:"选择格式"},{default:l(()=>[e(w,{label:"Excel",value:"excel"}),e(w,{label:"PDF",value:"pdf"}),e(w,{label:"CSV",value:"csv"}),e(w,{label:"JSON",value:"json"})]),_:1},8,["modelValue"])]),_:1}),e($,{label:"导出字段",prop:"fields"},{default:l(()=>[e(le,{modelValue:p.config.fields,"onUpdate:modelValue":n[4]||(n[4]=c=>p.config.fields=c)},{default:l(()=>[e(P,{label:"id"},{default:l(()=>[...n[11]||(n[11]=[s("ID",-1)])]),_:1}),e(P,{label:"title"},{default:l(()=>[...n[12]||(n[12]=[s("标题",-1)])]),_:1}),e(P,{label:"type"},{default:l(()=>[...n[13]||(n[13]=[s("类型",-1)])]),_:1}),e(P,{label:"status"},{default:l(()=>[...n[14]||(n[14]=[s("状态",-1)])]),_:1}),e(P,{label:"content"},{default:l(()=>[...n[15]||(n[15]=[s("内容",-1)])]),_:1}),e(P,{label:"creator"},{default:l(()=>[...n[16]||(n[16]=[s("创建者",-1)])]),_:1}),e(P,{label:"createdAt"},{default:l(()=>[...n[17]||(n[17]=[s("创建时间",-1)])]),_:1}),e(P,{label:"updatedAt"},{default:l(()=>[...n[18]||(n[18]=[s("更新时间",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e($,{label:"排序方式"},{default:l(()=>[e(L,{modelValue:p.config.sortBy,"onUpdate:modelValue":n[5]||(n[5]=c=>p.config.sortBy=c),placeholder:"选择排序字段"},{default:l(()=>[e(w,{label:"创建时间",value:"createdAt"}),e(w,{label:"更新时间",value:"updatedAt"}),e(w,{label:"标题",value:"title"})]),_:1},8,["modelValue"]),e(L,{modelValue:p.config.sortOrder,"onUpdate:modelValue":n[6]||(n[6]=c=>p.config.sortOrder=c),placeholder:"排序方向",style:{"margin-left":"8px",width:"100px"}},{default:l(()=>[e(w,{label:"升序",value:"asc"}),e(w,{label:"降序",value:"desc"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),pt=me(ut,[["__scopeId","data-v-e1a3fa41"]]),mt={class:"record-selector"},ct={class:"search-bar"},ft={class:"record-list"},_t={class:"pagination-wrapper"},vt={class:"actions"},gt={class:"selected-info"},yt={class:"action-buttons"},bt=Ve({__name:"RecordSelector",props:{modelValue:{}},emits:["update:modelValue","confirm","cancel"],setup(ne,{emit:H}){const I=ne,S=H,U=v(),k=v([]),F=v([]),V=v([...I.modelValue]),p=v(""),E=v(""),m=we({page:1,pageSize:20,total:0}),h=d=>se(d).format("YYYY-MM-DD HH:mm"),r=d=>({draft:"info",published:"success",archived:"warning"})[d]||"info",X=d=>({draft:"草稿",published:"已发布",archived:"已归档"})[d]||d,D=async()=>{try{const d={page:m.page,pageSize:m.pageSize};p.value&&(d.keyword=p.value),E.value&&(d.type=E.value);const i=await A.get(M.RECORDS.LIST,{params:d});k.value=i.items,m.total=i.total,rt(()=>{U.value&&k.value.forEach(C=>{V.value.some(O=>O.id===C.id)&&U.value.toggleRowSelection(C,!0)})})}catch(d){console.error("Failed to load records:",d),b.error("加载记录列表失败")}},Z=async()=>{try{const d=await A.get(M.RECORD_TYPES.LIST);F.value=d}catch(d){console.error("Failed to load record types:",d)}},q=d=>{const i=k.value.map(C=>C.id);V.value=V.value.filter(C=>!i.includes(C.id)),V.value.push(...d)},f=d=>{m.page=d,D()},n=d=>{m.pageSize=d,m.page=1,D()},ee=()=>{S("update:modelValue",V.value),S("confirm")};return he(()=>I.modelValue,d=>{V.value=[...d]},{deep:!0}),xe(()=>{D(),Z()}),(d,i)=>{const C=oe("Search"),J=fe,O=ce,te=Pe,Q=be,$=ye,w=ve,L=ge,P=_e,le=Ge;return u(),g("div",mt,[y("div",ct,[e(te,{modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=_=>p.value=_),placeholder:"搜索记录标题",clearable:"",onKeyup:nt(D,["enter"])},{append:l(()=>[e(O,{onClick:D},{default:l(()=>[e(J,null,{default:l(()=>[e(C)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e($,{modelValue:E.value,"onUpdate:modelValue":i[1]||(i[1]=_=>E.value=_),placeholder:"记录类型",clearable:"",onChange:D,style:{width:"150px","margin-left":"8px"}},{default:l(()=>[(u(!0),g(K,null,G(F.value,_=>(u(),j(Q,{key:_.id,label:_.name,value:_.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),y("div",ft,[e(P,{ref_key:"tableRef",ref:U,data:k.value,onSelectionChange:q,"max-height":"400",stripe:""},{default:l(()=>[e(w,{type:"selection",width:"55"}),e(w,{prop:"title",label:"标题","min-width":"200"}),e(w,{prop:"type",label:"类型",width:"120"},{default:l(({row:_})=>[e(L,{size:"small"},{default:l(()=>[s(R(_.type),1)]),_:2},1024)]),_:1}),e(w,{prop:"status",label:"状态",width:"100"},{default:l(({row:_})=>[e(L,{type:r(_.status),size:"small"},{default:l(()=>[s(R(X(_.status)),1)]),_:2},1032,["type"])]),_:1}),e(w,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(({row:_})=>[s(R(h(_.createdAt)),1)]),_:1})]),_:1},8,["data"])]),y("div",_t,[e(le,{"current-page":m.page,"onUpdate:currentPage":i[2]||(i[2]=_=>m.page=_),"page-size":m.pageSize,"onUpdate:pageSize":i[3]||(i[3]=_=>m.pageSize=_),"page-sizes":[10,20,50],total:m.total,layout:"total, sizes, prev, pager, next",onSizeChange:n,onCurrentChange:f},null,8,["current-page","page-size","total"])]),y("div",vt,[y("div",gt," 已选择 "+R(V.value.length)+" 条记录 ",1),y("div",yt,[e(O,{onClick:i[4]||(i[4]=_=>d.$emit("cancel"))},{default:l(()=>[...i[5]||(i[5]=[s("取消",-1)])]),_:1}),e(O,{type:"primary",onClick:ee},{default:l(()=>[...i[6]||(i[6]=[s(" 确定选择 ",-1)])]),_:1})])])])}}}),Vt=me(bt,[["__scopeId","data-v-709c0ea7"]]),wt={class:"export-view"},xt={key:0,class:"filter-section"},Et={key:1,class:"selected-section"},Ct={class:"selected-records"},Tt={key:0,class:"empty-selection"},Rt={key:1},kt={class:"selected-count"},St={class:"selected-list"},At={key:0,class:"more-count"},Dt={class:"field-selection"},Pt={class:"template-section"},Ut={class:"export-history"},$t={key:0,class:"empty-history"},ht={key:1},Mt={class:"history-header"},It={class:"history-format"},Ft={key:0,class:"history-progress"},Ot={class:"history-info"},Yt={class:"history-time"},zt={key:0,class:"history-error"},Lt={class:"history-actions"},Bt={key:0,class:"preview-content"},Nt={class:"preview-info"},jt=Ve({__name:"ExportView",setup(ne){Je();const H=v(),I=v(!1),S=v(!1),U=v(!1),k=v(!1),F=v([]),V=v([]),p=v([]),E=v([]),m=v([]),h=v(null),r=we({format:"excel",range:"all",filters:{type:[],status:[],dateRange:null,createdBy:[]},fields:["title","type","status","creator","createdAt"],templateId:null}),X=v(!1),D=v(!0),Z={format:[{required:!0,message:"请选择导出格式",trigger:"change"}],range:[{required:!0,message:"请选择数据范围",trigger:"change"}]},q=["id","title","type","status","content","creator","createdAt","updatedAt"],f=a=>se(a).format("YYYY-MM-DD HH:mm:ss"),n=a=>({pending:"info",processing:"warning",completed:"success",failed:"danger"})[a]||"info",ee=a=>({pending:"等待中",processing:"处理中",completed:"已完成",failed:"失败"})[a]||a,d=a=>({id:"ID",title:"标题",type:"类型",status:"状态",content:"内容",creator:"创建者",createdAt:"创建时间",updatedAt:"更新时间"})[a]||a,i=async()=>{try{const a=await A.get(M.RECORD_TYPES.LIST);F.value=a}catch(a){console.error("Failed to load record types:",a)}},C=async()=>{try{V.value=[{id:1,username:"admin",email:"admin@example.com",roles:[],createdAt:"",updatedAt:""}]}catch(a){console.error("Failed to load users:",a)}},J=async()=>{try{const a=await A.get(M.EXPORT.TEMPLATES);p.value=a}catch(a){console.error("Failed to load export templates:",a)}},O=async()=>{try{E.value=[]}catch(a){console.error("Failed to load export history:",a)}},te=a=>{a==="selected"&&(m.value=[])},Q=a=>{r.fields=a?[...q]:[],D.value=!1},$=a=>{const t=a.length;X.value=t===q.length,D.value=t>0&&t<q.length},w=a=>{const t=m.value.findIndex(x=>x.id===a.id);t>-1&&m.value.splice(t,1)},L=()=>{m.value=[]},P=async()=>{try{const a=_();a.preview=!0,a.limit=10;const t=await A.post("/export/preview",a);h.value=t,k.value=!0}catch(a){console.error("Preview failed:",a),b.error("预览失败")}},le=async()=>{if(H.value)try{if(await H.value.validate(),r.range==="selected"&&m.value.length===0){b.warning("请先选择要导出的记录");return}if(r.fields.length===0){b.warning("请至少选择一个导出字段");return}I.value=!0;const a=_(),t=await A.post(M.EXPORT.RECORDS,a);b.success("导出任务已创建，请在导出历史中查看进度"),E.value.unshift(t),re(t.id)}catch(a){console.error("Export failed:",a),b.error(a.message||"导出失败")}finally{I.value=!1}},_=()=>{const a={format:r.format,fields:r.fields};return r.templateId&&(a.templateId=r.templateId),r.range==="filtered"?a.filters=r.filters:r.range==="selected"&&(a.recordIds=m.value.map(t=>t.id)),a},re=a=>{const t=async()=>{try{const x=await A.get(`/export/tasks/${a}`),B=E.value.findIndex(T=>T.id===a);B>-1&&(E.value[B]=x),x.status==="processing"?setTimeout(t,2e3):x.status==="completed"?b.success("导出完成"):x.status==="failed"&&b.error("导出失败")}catch(x){console.error("Poll task status failed:",x)}};t()},c=()=>{Object.assign(r,{format:"excel",range:"all",filters:{type:[],status:[],dateRange:null,createdBy:[]},fields:["title","type","status","creator","createdAt"],templateId:null}),m.value=[],$(r.fields)},de=async a=>{if(a.fileUrl)try{const t=await A.get(M.EXPORT.DOWNLOAD(a.id),{responseType:"blob"}),x=new Blob([t]),B=window.URL.createObjectURL(x),T=document.createElement("a");T.href=B,T.download=`export_${a.id}_${se(a.createdAt).format("YYYY-MM-DD")}.${a.format}`,T.click(),window.URL.revokeObjectURL(B)}catch(t){console.error("Download failed:",t),b.error("下载失败")}},Me=async a=>{try{await A.post(`/export/tasks/${a.id}/cancel`);const t=E.value.findIndex(x=>x.id===a.id);t>-1&&(E.value[t].status="failed",E.value[t].error="用户取消"),b.success("导出任务已取消")}catch(t){console.error("Cancel task failed:",t),b.error("取消失败")}};return he(()=>r.fields,$,{immediate:!0}),xe(()=>{i(),C(),J(),O()}),(a,t)=>{const x=tt,B=et,T=De,ie=lt,W=be,ae=ye,Ie=ot,Ee=at,Y=ce,Ce=ge,z=$e,Fe=Ue,Oe=oe("Download"),ue=fe,Ye=oe("View"),ze=oe("Refresh"),Le=Ae,Te=Ze,Re=We,Be=st,Ne=Qe,je=Vt,pe=Se,He=pt,Xe=ve,qe=_e;return u(),g("div",wt,[e(Ne,{gutter:20},{default:l(()=>[e(Re,{xs:24,lg:16},{default:l(()=>[e(Te,{title:"数据导出"},{default:l(()=>[e(Le,{ref_key:"exportFormRef",ref:H,model:r,rules:Z,"label-width":"120px"},{default:l(()=>[e(T,{label:"导出格式",prop:"format"},{default:l(()=>[e(B,{modelValue:r.format,"onUpdate:modelValue":t[0]||(t[0]=o=>r.format=o)},{default:l(()=>[e(x,{label:"excel"},{default:l(()=>[...t[19]||(t[19]=[s("Excel",-1)])]),_:1}),e(x,{label:"pdf"},{default:l(()=>[...t[20]||(t[20]=[s("PDF",-1)])]),_:1}),e(x,{label:"csv"},{default:l(()=>[...t[21]||(t[21]=[s("CSV",-1)])]),_:1}),e(x,{label:"json"},{default:l(()=>[...t[22]||(t[22]=[s("JSON",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(T,{label:"数据范围",prop:"range"},{default:l(()=>[e(B,{modelValue:r.range,"onUpdate:modelValue":t[1]||(t[1]=o=>r.range=o),onChange:te},{default:l(()=>[e(ie,{label:"all"},{default:l(()=>[...t[23]||(t[23]=[s("全部数据",-1)])]),_:1}),e(ie,{label:"filtered"},{default:l(()=>[...t[24]||(t[24]=[s("筛选数据",-1)])]),_:1}),e(ie,{label:"selected"},{default:l(()=>[...t[25]||(t[25]=[s("选中数据",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),r.range==="filtered"?(u(),g("div",xt,[e(T,{label:"记录类型"},{default:l(()=>[e(ae,{modelValue:r.filters.type,"onUpdate:modelValue":t[2]||(t[2]=o=>r.filters.type=o),placeholder:"选择记录类型",clearable:"",multiple:""},{default:l(()=>[(u(!0),g(K,null,G(F.value,o=>(u(),j(W,{key:o.id,label:o.name,value:o.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(T,{label:"状态"},{default:l(()=>[e(ae,{modelValue:r.filters.status,"onUpdate:modelValue":t[3]||(t[3]=o=>r.filters.status=o),placeholder:"选择状态",clearable:"",multiple:""},{default:l(()=>[e(W,{label:"草稿",value:"draft"}),e(W,{label:"已发布",value:"published"}),e(W,{label:"已归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1}),e(T,{label:"创建时间"},{default:l(()=>[e(Ie,{modelValue:r.filters.dateRange,"onUpdate:modelValue":t[4]||(t[4]=o=>r.filters.dateRange=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(T,{label:"创建者"},{default:l(()=>[e(ae,{modelValue:r.filters.createdBy,"onUpdate:modelValue":t[5]||(t[5]=o=>r.filters.createdBy=o),placeholder:"选择创建者",clearable:"",multiple:"",filterable:""},{default:l(()=>[(u(!0),g(K,null,G(V.value,o=>(u(),j(W,{key:o.id,label:o.username,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])):N("",!0),r.range==="selected"?(u(),g("div",Et,[e(T,{label:"选中记录"},{default:l(()=>[y("div",Ct,[m.value.length===0?(u(),g("div",Tt,[e(Ee,{description:"请先选择要导出的记录"}),e(Y,{type:"primary",onClick:t[6]||(t[6]=o=>S.value=!0)},{default:l(()=>[...t[26]||(t[26]=[s(" 选择记录 ",-1)])]),_:1})])):(u(),g("div",Rt,[y("div",kt," 已选择 "+R(m.value.length)+" 条记录 ",1),y("div",St,[(u(!0),g(K,null,G(m.value.slice(0,10),o=>(u(),j(Ce,{key:o.id,closable:"",onClose:ke=>w(o)},{default:l(()=>[s(R(o.title),1)]),_:2},1032,["onClose"]))),128)),m.value.length>10?(u(),g("span",At," 等 "+R(m.value.length)+" 条记录 ",1)):N("",!0)]),e(Y,{size:"small",onClick:t[7]||(t[7]=o=>S.value=!0)},{default:l(()=>[...t[27]||(t[27]=[s(" 重新选择 ",-1)])]),_:1}),e(Y,{size:"small",type:"danger",onClick:L},{default:l(()=>[...t[28]||(t[28]=[s(" 清空选择 ",-1)])]),_:1})]))])]),_:1})])):N("",!0),e(T,{label:"导出字段"},{default:l(()=>[y("div",Dt,[e(z,{modelValue:X.value,"onUpdate:modelValue":t[8]||(t[8]=o=>X.value=o),indeterminate:D.value,onChange:Q},{default:l(()=>[...t[29]||(t[29]=[s(" 全选 ",-1)])]),_:1},8,["modelValue","indeterminate"]),e(Fe,{modelValue:r.fields,"onUpdate:modelValue":t[9]||(t[9]=o=>r.fields=o),onChange:$},{default:l(()=>[e(z,{label:"id"},{default:l(()=>[...t[30]||(t[30]=[s("ID",-1)])]),_:1}),e(z,{label:"title"},{default:l(()=>[...t[31]||(t[31]=[s("标题",-1)])]),_:1}),e(z,{label:"type"},{default:l(()=>[...t[32]||(t[32]=[s("类型",-1)])]),_:1}),e(z,{label:"status"},{default:l(()=>[...t[33]||(t[33]=[s("状态",-1)])]),_:1}),e(z,{label:"content"},{default:l(()=>[...t[34]||(t[34]=[s("内容",-1)])]),_:1}),e(z,{label:"creator"},{default:l(()=>[...t[35]||(t[35]=[s("创建者",-1)])]),_:1}),e(z,{label:"createdAt"},{default:l(()=>[...t[36]||(t[36]=[s("创建时间",-1)])]),_:1}),e(z,{label:"updatedAt"},{default:l(()=>[...t[37]||(t[37]=[s("更新时间",-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),e(T,{label:"导出模板"},{default:l(()=>[y("div",Pt,[e(ae,{modelValue:r.templateId,"onUpdate:modelValue":t[10]||(t[10]=o=>r.templateId=o),placeholder:"选择导出模板（可选）",clearable:""},{default:l(()=>[(u(!0),g(K,null,G(p.value,o=>(u(),j(W,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(Y,{onClick:t[11]||(t[11]=o=>U.value=!0)},{default:l(()=>[...t[38]||(t[38]=[s(" 管理模板 ",-1)])]),_:1})])]),_:1}),e(T,null,{default:l(()=>[e(Y,{type:"primary",loading:I.value,onClick:le},{default:l(()=>[e(ue,null,{default:l(()=>[e(Oe)]),_:1}),t[39]||(t[39]=s(" 开始导出 ",-1))]),_:1},8,["loading"]),e(Y,{onClick:P},{default:l(()=>[e(ue,null,{default:l(()=>[e(Ye)]),_:1}),t[40]||(t[40]=s(" 预览数据 ",-1))]),_:1}),e(Y,{onClick:c},{default:l(()=>[e(ue,null,{default:l(()=>[e(ze)]),_:1}),t[41]||(t[41]=s(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(Re,{xs:24,lg:8},{default:l(()=>[e(Te,{title:"导出历史"},{default:l(()=>[y("div",Ut,[E.value.length===0?(u(),g("div",$t,[e(Ee,{description:"暂无导出记录"})])):(u(),g("div",ht,[(u(!0),g(K,null,G(E.value,o=>(u(),g("div",{key:o.id,class:"history-item"},[y("div",Mt,[y("span",It,R(o.format.toUpperCase()),1),e(Ce,{type:n(o.status),size:"small"},{default:l(()=>[s(R(ee(o.status)),1)]),_:2},1032,["type"])]),o.status==="processing"?(u(),g("div",Ft,[e(Be,{percentage:o.progress},null,8,["percentage"])])):N("",!0),y("div",Ot,[y("p",Yt,R(f(o.createdAt)),1),o.error?(u(),g("p",zt,R(o.error),1)):N("",!0)]),y("div",Lt,[o.status==="completed"&&o.fileUrl?(u(),j(Y,{key:0,size:"small",type:"primary",onClick:ke=>de(o)},{default:l(()=>[...t[42]||(t[42]=[s(" 下载 ",-1)])]),_:1},8,["onClick"])):N("",!0),o.status==="processing"?(u(),j(Y,{key:1,size:"small",type:"warning",onClick:ke=>Me(o)},{default:l(()=>[...t[43]||(t[43]=[s(" 取消 ",-1)])]),_:1},8,["onClick"])):N("",!0)])]))),128))]))])]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:S.value,"onUpdate:modelValue":t[15]||(t[15]=o=>S.value=o),title:"选择记录",width:"80%",top:"5vh"},{default:l(()=>[e(je,{modelValue:m.value,"onUpdate:modelValue":t[12]||(t[12]=o=>m.value=o),onConfirm:t[13]||(t[13]=o=>S.value=!1),onCancel:t[14]||(t[14]=o=>S.value=!1)},null,8,["modelValue"])]),_:1},8,["modelValue"]),e(pe,{modelValue:U.value,"onUpdate:modelValue":t[17]||(t[17]=o=>U.value=o),title:"导出模板管理",width:"70%"},{default:l(()=>[e(He,{onTemplateUpdated:J,onClose:t[16]||(t[16]=o=>U.value=!1)})]),_:1},8,["modelValue"]),e(pe,{modelValue:k.value,"onUpdate:modelValue":t[18]||(t[18]=o=>k.value=o),title:"数据预览",width:"90%",top:"5vh"},{default:l(()=>[h.value?(u(),g("div",Bt,[y("div",Nt,[y("p",null,"预计导出 "+R(h.value.total)+" 条记录",1)]),e(qe,{data:h.value.items,stripe:"","max-height":"400"},{default:l(()=>[(u(!0),g(K,null,G(r.fields,o=>(u(),j(Xe,{key:o,prop:o,label:d(o),"show-overflow-tooltip":""},null,8,["prop","label"]))),128))]),_:1},8,["data"])])):N("",!0)]),_:1},8,["modelValue"])])}}}),ml=me(jt,[["__scopeId","data-v-ca4d817c"]]);export{ml as default};
//# sourceMappingURL=ExportView-AwDNunuz.js.map

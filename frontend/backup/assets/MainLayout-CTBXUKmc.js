import{_ as re}from"./_plugin-vue_export-helper-BJA4NJ9J.js";/* empty css                  *//* empty css                     *//* empty css                  */import"./el-tooltip-l0sNRNKZ.js";import{y as ce,r as T,c as U,aC as ie,h as de,I as r,J as e,R as t,B as i,P as u,z as E,a6 as k,Q as g,al as d,u as M,O as f,T as ue,aD as _e,M as h,aB as pe,A as s,K as F,S as H}from"./vendor-B2dHd6i_.js";import{u as me,h as fe,A as he}from"./index-Co-C_Vux.js";import{E as y,g as ye,h as ve,j as we,k as Ee,f as ge,l as be,m as xe,n as ke,o as Me,p as Se,q as Be,r as De,s as Ae,t as Ce,u as Ie,v as Te,w as Ue,x as Fe}from"./element-CUclIBtA.js";import"./utils-xdQVjYpF.js";const He={class:"logo"},Ne={class:"header-left"},Pe={class:"header-right"},Le={class:"user-info"},Re={class:"username"},Ve=ce({__name:"MainLayout",setup(qe){const S=ie(),B=pe(),p=me(),_=T(!1),v=T(!0),N=[{id:"dashboard",title:"仪表板",icon:"Dashboard",path:"/dashboard"},{id:"records",title:"记录管理",icon:"Document",path:"/records",permission:"records:read"},{id:"files",title:"文件管理",icon:"Folder",path:"/files",permission:"files:read"},{id:"export",title:"数据导出",icon:"Download",path:"/export",permission:"records:read"},{id:"admin",title:"系统管理",icon:"Setting",children:[{id:"users",title:"用户管理",icon:"User",path:"/users",permission:"users:read"},{id:"roles",title:"角色管理",icon:"UserFilled",path:"/roles",permission:"system:admin"},{id:"record-types",title:"记录类型",icon:"Collection",path:"/record-types",permission:"system:admin"},{id:"system",title:"系统设置",icon:"Tools",path:"/system",permission:"system:admin"}]}],P=U(()=>S.path),L=U(()=>S.matched.filter(a=>{var n;return(n=a.meta)==null?void 0:n.title}).map(a=>{var n;return{title:(n=a.meta)==null?void 0:n.title,path:a.path}})),R=()=>{_.value=!_.value},D=c=>{if(!c.permission)return!0;const[a,n,w="all"]=c.permission.split(":");return p.hasPermission(a,n,w)},b=async()=>{try{const c=await fe.get(he.SYSTEM.HEALTH);v.value=c.status==="healthy",v.value?y.success("系统运行正常"):y.warning("系统状态异常")}catch{v.value=!1,y.error("无法获取系统状态")}},V=async c=>{switch(c){case"profile":B.push("/profile");break;case"settings":y.info("设置功能开发中...");break;case"logout":try{await Ie.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await p.logout(),B.push("/login"),y.success("已退出登录")}catch{}break}};return de(()=>{b(),setInterval(b,6e4)}),(c,a)=>{const n=be,w=Ue,q=Te,z=ve,K=we,O=d("Expand"),j=d("Fold"),A=ge,J=Fe,Q=xe,Y=d("Monitor"),G=Me,W=ke,X=Be,Z=d("ArrowDown"),$=d("User"),x=Ae,ee=d("Setting"),te=d("SwitchButton"),oe=De,ne=Se,se=Ee,ae=d("router-view"),le=Ce,C=ye;return s(),r(C,{class:"main-layout"},{default:e(()=>[t(K,{width:_.value?"64px":"200px",class:"sidebar"},{default:e(()=>[i("div",He,[i("span",null,u(_.value?"信管":"信息管理系统"),1)]),t(z,{"default-active":P.value,collapse:_.value,"unique-opened":!0,router:"",class:"sidebar-menu"},{default:e(()=>[(s(),E(g,null,k(N,o=>(s(),E(g,{key:o.id},[o.children&&o.children.length>0?(s(),r(q,{key:0,index:o.id},{title:e(()=>[t(n,null,{default:e(()=>[(s(),r(h(o.icon)))]),_:2},1024),i("span",null,u(o.title),1)]),default:e(()=>[(s(!0),E(g,null,k(o.children,l=>F((s(),r(w,{key:l.id,index:l.path},{default:e(()=>[t(n,null,{default:e(()=>[(s(),r(h(l.icon)))]),_:2},1024),i("span",null,u(l.title),1)]),_:2},1032,["index"])),[[H,!l.hidden&&D(l)]])),128))]),_:2},1032,["index"])):F((s(),r(w,{key:1,index:o.path},{default:e(()=>[t(n,null,{default:e(()=>[(s(),r(h(o.icon)))]),_:2},1024),i("span",null,u(o.title),1)]),_:2},1032,["index"])),[[H,!o.hidden&&D(o)]])],64))),64))]),_:1},8,["default-active","collapse"])]),_:1},8,["width"]),t(C,null,{default:e(()=>[t(se,{class:"header"},{default:e(()=>[i("div",Ne,[t(A,{type:"text",onClick:R,class:"collapse-btn"},{default:e(()=>[t(n,null,{default:e(()=>[_.value?(s(),r(O,{key:0})):(s(),r(j,{key:1}))]),_:1})]),_:1}),t(Q,{separator:"/"},{default:e(()=>[(s(!0),E(g,null,k(L.value,o=>(s(),r(J,{key:o.path,to:o.path},{default:e(()=>[f(u(o.title),1)]),_:2},1032,["to"]))),128))]),_:1})]),i("div",Pe,[t(W,{content:"系统状态",placement:"bottom"},{default:e(()=>[t(G,{"is-dot":!v.value,type:"danger"},{default:e(()=>[t(A,{type:"text",onClick:b},{default:e(()=>[t(n,null,{default:e(()=>[t(Y)]),_:1})]),_:1})]),_:1},8,["is-dot"])]),_:1}),t(ne,{onCommand:V},{dropdown:e(()=>[t(oe,null,{default:e(()=>[t(x,{command:"profile"},{default:e(()=>[t(n,null,{default:e(()=>[t($)]),_:1}),a[0]||(a[0]=f(" 个人资料 ",-1))]),_:1}),t(x,{command:"settings"},{default:e(()=>[t(n,null,{default:e(()=>[t(ee)]),_:1}),a[1]||(a[1]=f(" 设置 ",-1))]),_:1}),t(x,{divided:"",command:"logout"},{default:e(()=>[t(n,null,{default:e(()=>[t(te)]),_:1}),a[2]||(a[2]=f(" 退出登录 ",-1))]),_:1})]),_:1})]),default:e(()=>{var o,l;return[i("div",Le,[t(X,{src:(o=M(p).user)==null?void 0:o.avatar,size:32},{default:e(()=>{var m,I;return[f(u((I=(m=M(p).user)==null?void 0:m.username)==null?void 0:I.charAt(0).toUpperCase()),1)]}),_:1},8,["src"]),i("span",Re,u((l=M(p).user)==null?void 0:l.username),1),t(n,null,{default:e(()=>[t(Z)]),_:1})])]}),_:1})])]),_:1}),t(le,{class:"main-content"},{default:e(()=>[t(ae,null,{default:e(({Component:o,route:l})=>[t(ue,{name:"fade-transform",mode:"out-in"},{default:e(()=>{var m;return[(m=l.meta)!=null&&m.keepAlive?(s(),r(_e,{key:0},[(s(),r(h(o),{key:l.path}))],1024)):(s(),r(h(o),{key:l.path}))]}),_:2},1024)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xe=re(Ve,[["__scopeId","data-v-c704f4fe"]]);export{Xe as default};
//# sourceMappingURL=MainLayout-CTBXUKmc.js.map

{"version":3,"file":"LoginView-CKwenYqG.js","sources":["../../src/views/auth/LoginView.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"login-card\">\r\n      <div class=\"login-header\">\r\n        <h2>信息管理系统</h2>\r\n        <p>欢迎登录</p>\r\n      </div>\r\n      \r\n      <el-form\r\n        ref=\"loginFormRef\"\r\n        :model=\"loginForm\"\r\n        :rules=\"loginRules\"\r\n        class=\"login-form\"\r\n        @keyup.enter=\"handleLogin\"\r\n      >\r\n        <el-form-item prop=\"username\">\r\n          <el-input\r\n            v-model=\"loginForm.username\"\r\n            placeholder=\"请输入用户名\"\r\n            size=\"large\"\r\n            prefix-icon=\"User\"\r\n            clearable\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item prop=\"password\">\r\n          <el-input\r\n            v-model=\"loginForm.password\"\r\n            type=\"password\"\r\n            placeholder=\"请输入密码\"\r\n            size=\"large\"\r\n            prefix-icon=\"Lock\"\r\n            show-password\r\n            clearable\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-checkbox v-model=\"rememberMe\">记住我</el-checkbox>\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"large\"\r\n            class=\"login-btn\"\r\n            :loading=\"authStore.isLoading\"\r\n            @click=\"handleLogin\"\r\n          >\r\n            登录\r\n          </el-button>\r\n        </el-form-item>\r\n        \r\n        <div class=\"login-footer\">\r\n          <router-link to=\"/register\" class=\"register-link\">\r\n            还没有账号？立即注册\r\n          </router-link>\r\n        </div>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, onMounted, watch } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage, type FormInstance, type FormRules } from 'element-plus'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport type { LoginRequest } from '@/types'\r\n\r\nconst router = useRouter()\r\nconst authStore = useAuthStore()\r\n\r\n// 表单引用\r\nconst loginFormRef = ref<FormInstance>()\r\n\r\n// 表单数据\r\nconst loginForm = reactive<LoginRequest>({\r\n  username: '',\r\n  password: ''\r\n})\r\n\r\n// 记住我\r\nconst rememberMe = ref(false)\r\n\r\n// 表单验证规则\r\nconst loginRules: FormRules = {\r\n  username: [\r\n    { required: true, message: '请输入用户名', trigger: 'blur' },\r\n    { min: 3, max: 20, message: '用户名长度在 3 到 20 个字符', trigger: 'blur' }\r\n  ],\r\n  password: [\r\n    { required: true, message: '请输入密码', trigger: 'blur' },\r\n    { min: 6, max: 50, message: '密码长度在 6 到 50 个字符', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 处理登录\r\nconst handleLogin = async () => {\r\n  if (!loginFormRef.value) return\r\n  \r\n  try {\r\n    await loginFormRef.value.validate()\r\n    \r\n    await authStore.login(loginForm)\r\n    \r\n    ElMessage.success('登录成功')\r\n    \r\n    // 跳转到首页或之前访问的页面\r\n    const redirect = router.currentRoute.value.query.redirect as string\r\n    router.push(redirect || '/')\r\n    \r\n  } catch (error: any) {\r\n    console.error('Login failed:', error)\r\n    ElMessage.error(error.message || '登录失败')\r\n  }\r\n}\r\n\r\n// 组件挂载时的处理\r\nonMounted(() => {\r\n  // 如果已经登录，直接跳转到首页\r\n  if (authStore.isAuthenticated) {\r\n    router.push('/')\r\n  }\r\n  \r\n  // 从localStorage恢复记住的用户名\r\n  const savedUsername = localStorage.getItem('rememberedUsername')\r\n  if (savedUsername) {\r\n    loginForm.username = savedUsername\r\n    rememberMe.value = true\r\n  }\r\n})\r\n\r\n// 监听记住我状态\r\nwatch(rememberMe, (newValue) => {\r\n  if (newValue && loginForm.username) {\r\n    localStorage.setItem('rememberedUsername', loginForm.username)\r\n  } else {\r\n    localStorage.removeItem('rememberedUsername')\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 100vh;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  padding: 20px;\r\n}\r\n\r\n.login-card {\r\n  width: 100%;\r\n  max-width: 400px;\r\n  background: white;\r\n  border-radius: 12px;\r\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\r\n  padding: 40px;\r\n}\r\n\r\n.login-header {\r\n  text-align: center;\r\n  margin-bottom: 32px;\r\n}\r\n\r\n.logo {\r\n  width: 64px;\r\n  height: 64px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.login-header h2 {\r\n  color: #303133;\r\n  margin-bottom: 8px;\r\n  font-size: 24px;\r\n  font-weight: 600;\r\n}\r\n\r\n.login-header p {\r\n  color: #909399;\r\n  font-size: 14px;\r\n}\r\n\r\n.login-form {\r\n  margin-top: 32px;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 44px;\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n}\r\n\r\n.login-footer {\r\n  text-align: center;\r\n  margin-top: 24px;\r\n}\r\n\r\n.register-link {\r\n  color: #409eff;\r\n  text-decoration: none;\r\n  font-size: 14px;\r\n}\r\n\r\n.register-link:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n/* 响应式设计 */\r\n@media (max-width: 480px) {\r\n  .login-card {\r\n    padding: 24px;\r\n    margin: 0 16px;\r\n  }\r\n  \r\n  .login-header h2 {\r\n    font-size: 20px;\r\n  }\r\n}\r\n</style>"],"names":["router","useRouter","authStore","useAuthStore","loginFormRef","ref","loginForm","reactive","rememberMe","loginRules","handleLogin","ElMessage","redirect","error","onMounted","savedUsername","watch","newValue","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_form","_component_el_form_item","_component_el_input","_cache","$event","_component_el_checkbox","_component_el_button","_unref","_hoisted_3","_component_router_link"],"mappings":"6kBAsEA,MAAMA,EAASC,EAAA,EACTC,EAAYC,EAAA,EAGZC,EAAeC,EAAA,EAGfC,EAAYC,EAAuB,CACvC,SAAU,GACV,SAAU,EAAA,CACX,EAGKC,EAAaH,EAAI,EAAK,EAGtBI,EAAwB,CAC5B,SAAU,CACR,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,MAAA,EAC9C,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,oBAAqB,QAAS,MAAA,CAAO,EAEnE,SAAU,CACR,CAAE,SAAU,GAAM,QAAS,QAAS,QAAS,MAAA,EAC7C,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,mBAAoB,QAAS,MAAA,CAAO,CAClE,EAIIC,EAAc,SAAY,CAC9B,GAAKN,EAAa,MAElB,GAAI,CACF,MAAMA,EAAa,MAAM,SAAA,EAEzB,MAAMF,EAAU,MAAMI,CAAS,EAE/BK,EAAU,QAAQ,MAAM,EAGxB,MAAMC,EAAWZ,EAAO,aAAa,MAAM,MAAM,SACjDA,EAAO,KAAKY,GAAY,GAAG,CAE7B,OAASC,EAAY,CACnB,QAAQ,MAAM,gBAAiBA,CAAK,EACpCF,EAAU,MAAME,EAAM,SAAW,MAAM,CACzC,CACF,EAGA,OAAAC,EAAU,IAAM,CAEVZ,EAAU,iBACZF,EAAO,KAAK,GAAG,EAIjB,MAAMe,EAAgB,aAAa,QAAQ,oBAAoB,EAC3DA,IACFT,EAAU,SAAWS,EACrBP,EAAW,MAAQ,GAEvB,CAAC,EAGDQ,EAAMR,EAAaS,GAAa,CAC1BA,GAAYX,EAAU,SACxB,aAAa,QAAQ,qBAAsBA,EAAU,QAAQ,EAE7D,aAAa,WAAW,oBAAoB,CAEhD,CAAC,uDA3IC,OAAAY,EAAA,EAAAC,EA2DM,MA3DNC,EA2DM,CA1DJC,EAyDM,MAzDNC,EAyDM,aAxDJD,EAGM,MAAA,CAHD,MAAM,gBAAc,CACvBA,EAAe,UAAX,QAAM,EACVA,EAAW,SAAR,MAAI,CAAA,OAGTE,EAkDUC,EAAA,SAjDJ,eAAJ,IAAIpB,EACH,MAAOE,EACP,MAAOG,EACR,MAAM,aACL,UAAaC,EAAW,CAAA,OAAA,CAAA,CAAA,aAEzB,IAQe,CARfa,EAQeE,EAAA,CARD,KAAK,YAAU,WAC3B,IAME,CANFF,EAMEG,EAAA,CALS,WAAApB,EAAU,SAAV,sBAAAqB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAtB,EAAU,SAAQsB,GAC3B,YAAY,SACZ,KAAK,QACL,cAAY,OACZ,UAAA,EAAA,iCAIJL,EAUeE,EAAA,CAVD,KAAK,YAAU,WAC3B,IAQE,CARFF,EAQEG,EAAA,CAPS,WAAApB,EAAU,SAAV,sBAAAqB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAtB,EAAU,SAAQsB,GAC3B,KAAK,WACL,YAAY,QACZ,KAAK,QACL,cAAY,OACZ,gBAAA,GACA,UAAA,EAAA,iCAIJL,EAEeE,EAAA,KAAA,WADb,IAAmD,CAAnDF,EAAmDM,EAAA,YAA7BrB,EAAA,2CAAAA,EAAU,MAAAoB,EAAA,aAAE,IAAG,CAAA,GAAAD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAH,MAAG,EAAA,CAAA,oCAGvCJ,EAUeE,EAAA,KAAA,WATb,IAQY,CARZF,EAQYO,EAAA,CAPV,KAAK,UACL,KAAK,QACL,MAAM,YACL,QAASC,EAAA7B,CAAA,EAAU,UACnB,QAAOQ,CAAA,aACT,IAED,CAAA,GAAAiB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFC,OAED,EAAA,CAAA,iCAGFN,EAIM,MAJNW,EAIM,CAHJT,EAEcU,EAAA,CAFD,GAAG,YAAY,MAAM,eAAA,aAAgB,IAElD,CAAA,GAAAN,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFkD,eAElD,EAAA,CAAA"}
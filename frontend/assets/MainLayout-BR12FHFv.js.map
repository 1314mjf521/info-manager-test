{"version":3,"file":"MainLayout-BR12FHFv.js","sources":["../../src/layout/MainLayout.vue"],"sourcesContent":["<template>\r\n  <el-container class=\"layout-container\">\r\n    <!-- 侧边栏 -->\r\n    <el-aside :width=\"isCollapse ? '64px' : '200px'\" class=\"sidebar\">\r\n      <div class=\"logo\">\r\n        <span>{{ isCollapse ? '信管' : '信息管理系统' }}</span>\r\n      </div>\r\n      \r\n      <el-menu\r\n        :default-active=\"$route.path\"\r\n        :collapse=\"isCollapse\"\r\n        :unique-opened=\"true\"\r\n        router\r\n        class=\"sidebar-menu\"\r\n      >\r\n        <template v-for=\"item in menuItems\" :key=\"item.path\">\r\n          <el-menu-item\r\n            v-if=\"!item.hidden && hasPermission(item.permission)\"\r\n            :index=\"item.path\"\r\n          >\r\n            <el-icon><component :is=\"item.icon\" /></el-icon>\r\n            <template #title>{{ item.title }}</template>\r\n          </el-menu-item>\r\n        </template>\r\n      </el-menu>\r\n    </el-aside>\r\n\r\n    <el-container>\r\n      <!-- 头部 -->\r\n      <el-header class=\"header\">\r\n        <div class=\"header-left\">\r\n          <el-button type=\"text\" @click=\"toggleCollapse\">\r\n            <el-icon><Expand v-if=\"isCollapse\" /><Fold v-else /></el-icon>\r\n          </el-button>\r\n          \r\n          <el-breadcrumb separator=\"/\">\r\n            <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n            <el-breadcrumb-item v-if=\"$route.meta?.title\">\r\n              {{ $route.meta.title }}\r\n            </el-breadcrumb-item>\r\n          </el-breadcrumb>\r\n        </div>\r\n        \r\n        <div class=\"header-right\">\r\n          <!-- 系统健康状态 -->\r\n          <el-tooltip content=\"系统状态\" placement=\"bottom\">\r\n            <el-badge :is-dot=\"!systemHealthy\" type=\"danger\">\r\n              <el-button type=\"text\" @click=\"checkSystemHealth\">\r\n                <el-icon><Monitor /></el-icon>\r\n              </el-button>\r\n            </el-badge>\r\n          </el-tooltip>\r\n          \r\n          <!-- 用户菜单 -->\r\n          <el-dropdown @command=\"handleUserCommand\">\r\n            <span class=\"user-dropdown\">\r\n              <el-avatar :size=\"32\" :src=\"authStore.user?.avatar\">\r\n                {{ authStore.user?.username?.charAt(0).toUpperCase() }}\r\n              </el-avatar>\r\n              <span class=\"username\">{{ authStore.user?.username }}</span>\r\n              <el-icon><ArrowDown /></el-icon>\r\n            </span>\r\n            <template #dropdown>\r\n              <el-dropdown-menu>\r\n                <el-dropdown-item command=\"profile\">\r\n                  <el-icon><User /></el-icon>\r\n                  个人资料\r\n                </el-dropdown-item>\r\n                <el-dropdown-item divided command=\"logout\">\r\n                  <el-icon><SwitchButton /></el-icon>\r\n                  退出登录\r\n                </el-dropdown-item>\r\n              </el-dropdown-menu>\r\n            </template>\r\n          </el-dropdown>\r\n        </div>\r\n      </el-header>\r\n\r\n      <!-- 主内容区 -->\r\n      <el-main class=\"main-content\">\r\n        <router-view />\r\n      </el-main>\r\n    </el-container>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport {\r\n  Expand,\r\n  Fold,\r\n  Monitor,\r\n  User,\r\n  ArrowDown,\r\n  SwitchButton,\r\n  Dashboard,\r\n  Document,\r\n  Collection,\r\n  Folder,\r\n  Download,\r\n  UserFilled,\r\n  Setting\r\n} from '@element-plus/icons-vue'\r\nimport { useAuthStore } from '@/stores/auth'\r\n\r\nconst router = useRouter()\r\nconst authStore = useAuthStore()\r\n\r\n// 侧边栏折叠状态\r\nconst isCollapse = ref(false)\r\nconst systemHealthy = ref(true)\r\n\r\n// 菜单项\r\nconst menuItems = computed(() => [\r\n  {\r\n    path: '/dashboard',\r\n    title: '仪表板',\r\n    icon: 'Dashboard',\r\n    permission: null,\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/records',\r\n    title: '记录管理',\r\n    icon: 'Document',\r\n    permission: 'records:read',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/record-types',\r\n    title: '记录类型',\r\n    icon: 'Collection',\r\n    permission: 'system:admin',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/files',\r\n    title: '文件管理',\r\n    icon: 'Folder',\r\n    permission: 'files:read',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/export',\r\n    title: '数据导出',\r\n    icon: 'Download',\r\n    permission: 'records:read',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/users',\r\n    title: '用户管理',\r\n    icon: 'User',\r\n    permission: 'users:read',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/roles',\r\n    title: '角色管理',\r\n    icon: 'UserFilled',\r\n    permission: 'system:admin',\r\n    hidden: false\r\n  },\r\n  {\r\n    path: '/system',\r\n    title: '系统管理',\r\n    icon: 'Setting',\r\n    permission: 'system:admin',\r\n    hidden: false\r\n  }\r\n])\r\n\r\n// 权限检查\r\nconst hasPermission = (permission: string | null) => {\r\n  if (!permission) return true\r\n  const [resource, action, scope = 'all'] = permission.split(':')\r\n  return authStore.hasPermission(resource, action, scope)\r\n}\r\n\r\n// 切换侧边栏\r\nconst toggleCollapse = () => {\r\n  isCollapse.value = !isCollapse.value\r\n}\r\n\r\n// 检查系统健康状态\r\nconst checkSystemHealth = async () => {\r\n  try {\r\n    // TODO: 调用系统健康检查API\r\n    if (systemHealthy.value) {\r\n      ElMessage.success('系统运行正常')\r\n    } else {\r\n      ElMessage.warning('系统状态异常')\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('无法获取系统状态')\r\n  }\r\n}\r\n\r\n// 用户菜单命令处理\r\nconst handleUserCommand = async (command: string) => {\r\n  switch (command) {\r\n    case 'profile':\r\n      router.push('/profile')\r\n      break\r\n    case 'logout':\r\n      try {\r\n        await ElMessageBox.confirm('确定要退出登录吗？', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        })\r\n        \r\n        await authStore.logout()\r\n        ElMessage.success('已退出登录')\r\n        router.push('/login')\r\n      } catch (error) {\r\n        // 用户取消\r\n      }\r\n      break\r\n  }\r\n}\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  // 初始化系统状态检查\r\n  checkSystemHealth()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.layout-container {\r\n  height: 100vh;\r\n}\r\n\r\n.sidebar {\r\n  background-color: #304156;\r\n  transition: width 0.3s;\r\n}\r\n\r\n.logo {\r\n  height: 60px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #2b3a4b;\r\n  color: white;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n}\r\n\r\n.sidebar-menu {\r\n  border: none;\r\n  background-color: #304156;\r\n}\r\n\r\n.sidebar-menu .el-menu-item {\r\n  color: #bfcbd9;\r\n}\r\n\r\n.sidebar-menu .el-menu-item:hover {\r\n  background-color: #263445;\r\n  color: #409eff;\r\n}\r\n\r\n.sidebar-menu .el-menu-item.is-active {\r\n  background-color: #409eff;\r\n  color: white;\r\n}\r\n\r\n.header {\r\n  background-color: white;\r\n  border-bottom: 1px solid #e4e7ed;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 20px;\r\n}\r\n\r\n.header-left {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 20px;\r\n}\r\n\r\n.header-right {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 15px;\r\n}\r\n\r\n.user-dropdown {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  cursor: pointer;\r\n  padding: 5px 10px;\r\n  border-radius: 4px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.user-dropdown:hover {\r\n  background-color: #f5f7fa;\r\n}\r\n\r\n.username {\r\n  font-size: 14px;\r\n  color: #606266;\r\n}\r\n\r\n.main-content {\r\n  background-color: #f0f2f5;\r\n  padding: 20px;\r\n  overflow-y: auto;\r\n}\r\n\r\n/* 响应式设计 */\r\n@media (max-width: 768px) {\r\n  .sidebar {\r\n    width: 64px !important;\r\n  }\r\n  \r\n  .header {\r\n    padding: 0 10px;\r\n  }\r\n  \r\n  .main-content {\r\n    padding: 10px;\r\n  }\r\n  \r\n  .username {\r\n    display: none;\r\n  }\r\n}\r\n</style>"],"names":["router","useRouter","authStore","useAuthStore","isCollapse","ref","systemHealthy","menuItems","computed","hasPermission","permission","resource","action","scope","toggleCollapse","checkSystemHealth","ElMessage","handleUserCommand","command","ElMessageBox","onMounted","_createBlock","_component_el_container","_createVNode","_component_el_aside","_createElementVNode","_hoisted_1","_component_el_menu","$route","_createElementBlock","_Fragment","_renderList","item","_component_el_menu_item","_createTextVNode","_toDisplayString","_component_el_icon","_resolveDynamicComponent","_component_el_header","_hoisted_2","_component_el_button","_unref","Expand","Fold","_component_el_breadcrumb","_component_el_breadcrumb_item","_cache","_hoisted_3","_component_el_tooltip","_component_el_badge","Monitor","_component_el_dropdown","_component_el_dropdown_menu","_component_el_dropdown_item","User","SwitchButton","_hoisted_4","_component_el_avatar","_hoisted_5","ArrowDown","_component_el_main","_component_router_view"],"mappings":"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"}